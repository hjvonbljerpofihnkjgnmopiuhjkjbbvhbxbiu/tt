<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheet Selector</title>
    <style>
        body {
            background-color: #121212;
            color: white;
            font-family: Arial, sans-serif;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 10px;
            border: 1px solid #444;
            text-align: left;
        }

        th {
            background-color: #1e1e1e;
            position: sticky;
            top: 0;
        }

        select {
            background-color: #333;
            color: white;
            border: 1px solid #444;
            padding: 5px;
        }

        #container {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Google Sheet Selector</h1>

    <!-- Dropdown list -->
    <label for="selector">SÃ©lectionnez un nom :</label>
    <select id="selector">
        <!-- Options will be populated dynamically -->
    </select>

    <!-- Container to display selected row -->
    <div id="container">
        <table id="data-table">
            <thead>
                <tr id="header-row">
                    <!-- Header cells will be populated dynamically -->
                </tr>
            </thead>
            <tbody id="selected-row">
                <!-- Selected row will appear here -->
            </tbody>
            <tbody id="last-rows">
                <!-- Last 5 rows will be displayed here -->
            </tbody>
        </table>
    </div>

    <script>
        const sheetUrl1 = 'https://docs.google.com/spreadsheets/d/1M19pAtJYNnDCaKxhO5XjWIlxqT7p2zvk6FHqKYVBJ1g/gviz/tq?tqx=out:csv&gid=582059801';
        const sheetUrl2 = 'https://docs.google.com/spreadsheets/d/1M19pAtJYNnDCaKxhO5XjWIlxqT7p2zvk6FHqKYVBJ1g/gviz/tq?tqx=out:csv&gid=946596354';

        // Load CSV data and parse it
        async function fetchCsv(url) {
            const response = await fetch(url);
            const data = await response.text();
            return data.split('\n').map(row => row.split(','));
        }

        // Populate the dropdown and table
        async function initialize() {
            const data1 = await fetchCsv(sheetUrl1);
            const data2 = await fetchCsv(sheetUrl2);

            const header = data1[4]; // B5 to X5
            const rows = data1.slice(5, 35); // B6 to X35
            const last5Rows = data2.slice(-5); // Last 5 rows from second sheet

            const selector = document.getElementById('selector');
            const headerRow = document.getElementById('header-row');
            const selectedRowContainer = document.getElementById('selected-row');
            const lastRowsContainer = document.getElementById('last-rows');

            // Populate header row (B5 to X5)
            header.forEach(cell => {
                const th = document.createElement('th');
                th.textContent = cell;
                headerRow.appendChild(th);
            });

            // Populate dropdown with values from column D (D6 to D35)
            rows.forEach((row, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = row[3]; // Column D
                selector.appendChild(option);
            });

            // Update table based on selected dropdown option
            selector.addEventListener('change', (event) => {
                const selectedIndex = event.target.value;
                const selectedRow = rows[selectedIndex];

                selectedRowContainer.innerHTML = ''; // Clear previous content

                const tr = document.createElement('tr');
                selectedRow.forEach(cell => {
                    const td = document.createElement('td');
                    td.textContent = cell;
                    tr.appendChild(td);
                });

                selectedRowContainer.appendChild(tr);
            });

            // Populate the last 5 rows from the second sheet
            last5Rows.forEach(row => {
                const tr = document.createElement('tr');
                row.forEach(cell => {
                    const td = document.createElement('td');
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                lastRowsContainer.appendChild(tr);
            });
        }

        // Initialize everything on page load
        initialize();
    </script>
</body>
</html>
