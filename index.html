<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheet Table</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        td {
            cursor: pointer;
        }
    </style>
</head>
<body>

<h2>Tableau des partenaires</h2>

<table id="sheetTable">
    <!-- Le tableau sera inséré ici -->
</table>

<script>
    // Remplacez par votre propre clé API Google Sheets
    const apiKey = 'AIzaSyBpcBw4PhPUq7k5FdkfzvMyRxEyCjmpkK0';
    const spreadsheetId = '1M19pAtJYNnDCaKxhO5XjWIlxqT7p2zvk6FHqKYVBJ1g';
    const range = 'Partenaires!B2:J25'; // Le range que vous voulez afficher

    // Fonction pour récupérer les données Google Sheets
    async function fetchSheetData() {
        const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}?key=${apiKey}`;
        try {
            const response = await fetch(url);
            const data = await response.json();
            displayTable(data.values);
        } catch (error) {
            console.error('Erreur lors de la récupération des données:', error);
        }
    }

    // Fonction pour afficher les données dans un tableau HTML
    function displayTable(data) {
        const table = document.getElementById('sheetTable');
        const headerRow = data[0];  // Supposons que la première ligne contient les titres
        let tableHtml = '<thead><tr>';
        
        // Générer les en-têtes de colonnes
        headerRow.forEach(header => {
            tableHtml += `<th>${header}</th>`;
        });
        tableHtml += '</tr></thead><tbody>';
        
        // Générer les lignes du tableau
        for (let rowIndex = 1; rowIndex < data.length; rowIndex++) {
            const row = data[rowIndex];
            tableHtml += '<tr>';
            row.forEach((cell, colIndex) => {
                const cellId = `R${rowIndex+1}C${colIndex+2}`; // Ex: R2C4 pour ligne 2, colonne 4 (réel)
                tableHtml += `<td id="${cellId}" data-row="${rowIndex + 1}" data-col="${colIndex + 2}">${cell}</td>`;
            });
            tableHtml += '</tr>';
        }

        tableHtml += '</tbody>';
        table.innerHTML = tableHtml;

        // Ajouter les événements de clic aux cellules des colonnes D à I (index 3 à 8)
        const tableCells = document.querySelectorAll('#sheetTable td');
        tableCells.forEach(cell => {
            const colIndex = parseInt(cell.getAttribute('data-col'));
            const rowIndex = parseInt(cell.getAttribute('data-row'));
            if (colIndex >= 4 && colIndex <= 9) {  // Colonnes D à I
                cell.addEventListener('click', () => handleCellClick(rowIndex, colIndex));
            }
        });
    }

    // Fonction de gestion du clic sur une cellule des colonnes D à I
    function handleCellClick(rowIndex, colIndex) {
        const colCValue = document.querySelector(`#R${rowIndex}C3`).textContent;  // Valeur de la colonne C
        const colHeaderValue = document.querySelector(`#R3C${colIndex}`).textContent;  // Valeur de la 3ème ligne (en-tête)

        const concatenatedValue = colCValue + '+' + colHeaderValue;
        console.log('Valeur à copier:', concatenatedValue);

        // Copier dans le presse-papier
        navigator.clipboard.writeText(concatenatedValue)
            .then(() => {
                alert(`Valeur copiée dans le presse-papier: ${concatenatedValue}`);
            })
            .catch(err => {
                console.error('Erreur lors de la copie:', err);
            });
    }

    // Récupérer et afficher les données lorsque la page est chargée
    fetchSheetData();

</script>

</body>
</html>
