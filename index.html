<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheet Partenaires</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }
        td:hover {
            background-color: #f0f0f0;
            cursor: pointer;
        }
    </style>
</head>
<body>

<h1>Tableau des Partenaires</h1>
<table id="partenaires-table">
    <!-- Le tableau sera rempli dynamiquement par JavaScript -->
</table>

<script>
// Remplacer par votre clé API Google Sheets
const API_KEY = 'AIzaSyBpcBw4PhPUq7k5FdkfzvMyRxEyCjmpkK0';

// L'ID de votre Google Sheet
const SPREADSHEET_ID = '1M19pAtJYNnDCaKxhO5XjWIlxqT7p2zvk6FHqKYVBJ1g';

// Le nom de la feuille
const SHEET_NAME = 'Partenaires';

// La plage que nous voulons récupérer (B2:J25)
const RANGE = `${SHEET_NAME}!B2:J25`;

// Fonction pour récupérer les données de Google Sheets
async function fetchSheetData() {
    const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${RANGE}?key=${API_KEY}`);
    const data = await response.json();
    return data.values;
}

// Fonction pour remplir le tableau HTML avec les données
function fillTable(data) {
    const table = document.getElementById('partenaires-table');
    data.forEach((row, rowIndex) => {
        const tr = document.createElement('tr');
        row.forEach((cell, colIndex) => {
            const td = document.createElement('td');
            td.textContent = cell;
            tr.appendChild(td);

            // Ajouter l'événement de clic sur les colonnes D à I (index 3 à 8)
            if (colIndex >= 3 && colIndex <= 8 && rowIndex >= 0) {
                td.addEventListener('click', () => {
                    const colLetter = String.fromCharCode(68 + colIndex - 3); // Convertir l'index en lettre (D, E, F...)
                    const cellValueC = data[rowIndex][1]; // Récupérer la valeur de la colonne C dans la même ligne
                    const cellValueRow3 = data[0][colIndex]; // Récupérer la valeur de la ligne 3 dans la même colonne

                    // Copier les valeurs dans le presse-papier
                    const copyText = `${cellValueC} ${cellValueRow3}`;
                    navigator.clipboard.writeText(copyText).then(() => {
                        alert(`Copié: ${copyText}`);
                    }).catch(err => {
                        console.error('Erreur lors de la copie: ', err);
                    });
                });
            }
        });
        table.appendChild(tr);
    });
}

// Charger les données et remplir le tableau
fetchSheetData().then(data => {
    fillTable(data);
});
</script>

</body>
</html>
