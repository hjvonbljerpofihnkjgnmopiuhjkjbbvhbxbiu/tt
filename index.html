<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets Data</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
        }
        tr:hover {
            background-color: #f1f1f1;
        }
        td {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Google Sheets Data (B2:J25)</h1>
    <table id="data-table"></table>

    <script>
        const apiKey = 'AIzaSyBpcBw4PhPUq7k5FdkfzvMyRxEyCjmpkK0'; // Insère ta clé API ici
        const spreadsheetId = '1M19pAtJYNnDCaKxhO5XjWIlxqT7p2zvk6FHqKYVBJ1g';
        const range = 'B2:J25';

        function getData() {
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}?key=${apiKey}`;
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    displayData(data.values);
                })
                .catch(error => console.error('Error:', error));
        }

        function displayData(data) {
            const table = document.getElementById('data-table');
            const headerRow = document.createElement('tr');

            // Ajoute les en-têtes de colonnes
            const headers = ['B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'];
            headers.forEach(headerText => {
                const headerCell = document.createElement('th');
                headerCell.textContent = headerText;
                headerRow.appendChild(headerCell);
            });
            table.appendChild(headerRow);

            // Ajoute les lignes et les cellules
            data.forEach((row, rowIndex) => {
                const rowElement = document.createElement('tr');
                row.forEach((cell, colIndex) => {
                    const cellElement = document.createElement('td');
                    cellElement.textContent = cell;
                    rowElement.appendChild(cellElement);

                    // Ajoute des événements pour les cellules des colonnes D à I (index 3 à 8)
                    if (colIndex >= 3 && colIndex <= 8) {
                        cellElement.addEventListener('click', () => {
                            const rowCValue = data[rowIndex][1];  // Valeur de la colonne C de la même ligne
                            const row3Value = data[1][colIndex];  // Valeur de la ligne 3 dans la même colonne
                            alert(`Valeur de C${rowIndex + 2}: ${rowCValue}\nValeur de ${headers[colIndex]}3: ${row3Value}`);
                        });
                    }
                });
                table.appendChild(rowElement);
            });
        }

        // Charge les données lorsque la page est prête
        document.addEventListener('DOMContentLoaded', getData);
    </script>
</body>
</html>
